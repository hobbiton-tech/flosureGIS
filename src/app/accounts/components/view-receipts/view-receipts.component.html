<nz-spin
    [nzSize]="'large'"
    [nzSpinning]="loadingReceipt"
    [nzTip]="'Loading PDF'"
>
    <div style="margin: 15px;">
        <nz-breadcrumb>
            <nz-breadcrumb-item>
                Finance
            </nz-breadcrumb-item>
            <nz-breadcrumb-item>
                Receipts
            </nz-breadcrumb-item>
            <nz-breadcrumb-item>
                View Receipts
            </nz-breadcrumb-item>
        </nz-breadcrumb>
        <nz-page-header nzBackIcon [nzTitle]="title">
            <ng-template #title>
                <div style="display: flex; align-items: center;">
                    <span style="margin-right: 8px;">Receipt </span>
                </div>
            </ng-template>
            <nz-page-header-extra>
                <button nz-button nzType="primary" (click)="htmlToPdf()">
                    Print
                </button>
                <button nz-button nzType="primary">
                    Email
                </button>
                <button nz-button nzType="primary">
                    Download
                </button>
            </nz-page-header-extra>
        </nz-page-header>
        <nz-card>
            <nz-divider
                nzText="Receipt Details"
                nzOrientation="left"
            ></nz-divider>
            <nz-spin [nzSpinning]="generatingPDF">
                <div class="invoice-box" id="printSection">
                    <TABLE
                        WIDTH="100%"
                        CELLPADDING="7"
                        CELLSPACING="0"
                        STYLE="page-break-before: always"
                    >
                        <COL WIDTH="126*" />
                        <COL WIDTH="62*" />
                        <COL WIDTH="69*" />
                        <TR>
                            <TD
                                WIDTH="49%"
                                HEIGHT="33"
                                BGCOLOR="#ffffff"
                                STYLE="border: none; padding: 0in"
                            >
                                <P
                                    ><A NAME="_GoBack"></A
                                    ><img
                                        src="assets/images/apluslogo.png"
                                        style="width: 100%; max-width: 300px;"
                                /></P>
                            </TD>
                            <TD
                                WIDTH="24%"
                                VALIGN="BOTTOM"
                                BGCOLOR="#ffffff"
                                STYLE="border: none; padding: 0in"
                            >
                                <P><BR /> </P>
                            </TD>
                            <TD
                                WIDTH="27%"
                                BGCOLOR="#ffffff"
                                STYLE="border: none; padding: 0in"
                            >
                                <P ALIGN="RIGHT">
                                    A Plus General Insurance<br />
                                    Plot No. 402, Roma Park, Zambezi Road<br />
                                    P.O. Box 31700, Lusaka Zambia<br />
                                    Tel: +260 211 239865/6 - Tele/Fax:+260 211
                                    239867<br />
                                    E-mail: info@aplusgeneral.com<br />
                                </P>
                            </TD>
                        </TR>
                        <TR>
                            <TD
                                WIDTH="49%"
                                HEIGHT="5"
                                BGCOLOR="#ffffff"
                                STYLE="border: none; padding: 0in"
                            >
                                <!-- <P
                                    ><FONT FACE="Arial, serif"
                                        ><FONT SIZE="2"
                                            >[Street Address]</FONT
                                        ></FONT
                                    >
                                    </P
                                >-->
                            </TD>
                            <TD
                                WIDTH="24%"
                                BGCOLOR="#ffffff"
                                STYLE="border: none; padding: 0in"
                            >
                                <P><BR /> </P>
                            </TD>
                            <TD
                                WIDTH="27%"
                                VALIGN="BOTTOM"
                                BGCOLOR="#ffffff"
                                STYLE="border: none; padding: 0in"
                            >
                                <P><BR /> </P>
                            </TD>
                        </TR>
                        <TR>
                            <TD
                                WIDTH="49%"
                                HEIGHT="5"
                                BGCOLOR="#ffffff"
                                STYLE="border: none; padding: 0in"
                            >
                                <!-- <P
                                    ><FONT FACE="Arial, serif"
                                        ><FONT SIZE="2"
                                            >[City, ST ZIP]</FONT
                                        ></FONT
                                    ></P
                                > -->
                            </TD>
                            <TD
                                WIDTH="24%"
                                BGCOLOR="#d2d9eb"
                                STYLE="border-top: 1px solid #808080; border-bottom: 1px solid #808080; border-left: 1px solid #808080; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.08in; padding-right: 0in"
                            >
                                <P ALIGN="LEFT"
                                    ><FONT FACE="Arial, serif"
                                        ><FONT SIZE="2" STYLE="font-size: 9pt"
                                            ><B>Receipt #</B></FONT
                                        ></FONT
                                    ></P
                                >
                            </TD>
                            <TD
                                WIDTH="27%"
                                BGCOLOR="#d2d9eb"
                                STYLE="border: 1px solid #808080; padding: 0in 0.08in"
                            >
                                <P ALIGN="LEFT"
                                    ><FONT FACE="Arial, serif"
                                        ><FONT SIZE="2" STYLE="font-size: 9pt"
                                            ><B>Invoice #</B></FONT
                                        ></FONT
                                    ></P
                                >
                            </TD>
                        </TR>
                        <TR>
                            <TD
                                WIDTH="49%"
                                HEIGHT="5"
                                BGCOLOR="#ffffff"
                                STYLE="border: none; padding: 0in"
                            >
                                <P
                                    ><FONT FACE="Arial, serif"
                                        ><FONT SIZE="2"
                                            >Tpin:
                                            <span style="color: red;"
                                                >{{
                                                  receipt.tpinNumber
                                                }}</span
                                            ></FONT
                                        ></FONT
                                    ></P
                                >
                            </TD>
                            <TD
                                WIDTH="24%"
                                BGCOLOR="#ffffff"
                                STYLE="border-top: 1px solid #808080; border-bottom: 1px solid #808080; border-left: 1px solid #808080; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.08in; padding-right: 0in"
                            >
                                <P ALIGN="LEFT"
                                    ><FONT FACE="Arial, serif"
                                        ><FONT SIZE="2">{{
                                            receipt.receiptNumber
                                        }}</FONT></FONT
                                    ></P
                                >
                            </TD>
                            <TD
                                WIDTH="27%"
                                BGCOLOR="#ffffff"
                                STYLE="border: 1px solid #808080; padding: 0in 0.08in"
                            >
                                <P ALIGN="LEFT"
                                    ><FONT FACE="Arial, serif"
                                        ><FONT SIZE="2">{{
                                            receipt.invoiceNumber
                                        }}</FONT></FONT
                                    ></P
                                >
                            </TD>
                        </TR>
                        <TR>
                            <TD
                                WIDTH="49%"
                                HEIGHT="5"
                                BGCOLOR="#ffffff"
                                STYLE="border: none; padding: 0in"
                            >
                                <P><BR /> </P>
                            </TD>
                            <TD
                                WIDTH="24%"
                                BGCOLOR="#ffffff"
                                STYLE="border-top: 1px solid #808080; border-bottom: none; border-left: none; border-right: none; padding: 0in"
                            >
                                <P><BR /> </P>
                            </TD>
                            <TD
                                WIDTH="27%"
                                VALIGN="BOTTOM"
                                BGCOLOR="#ffffff"
                                STYLE="border-top: 1px solid #808080; border-bottom: none; border-left: none; border-right: none; padding: 0in"
                            >
                                <P><BR /> </P>
                            </TD>
                        </TR>
                        <TR>
                            <TD
                                WIDTH="49%"
                                HEIGHT="5"
                                BGCOLOR="#ffffff"
                                STYLE="border: none; padding: 0in"
                            >
                                <P><BR /> </P>
                            </TD>
                            <TD
                                WIDTH="24%"
                                BGCOLOR="#ffffff"
                                STYLE="border: none; padding: 0in"
                            >
                                <P><BR /> </P>
                            </TD>
                            <TD
                                WIDTH="27%"
                                VALIGN="BOTTOM"
                                BGCOLOR="#ffffff"
                                STYLE="border: none; padding: 0in"
                            >
                                <P><BR /> </P>
                            </TD>
                        </TR>
                    </TABLE>
                    <P STYLE="margin-bottom: 0.11in"><BR /><BR /> </P>
                    <TABLE WIDTH="205" CELLPADDING="7" CELLSPACING="0">
                        <COL WIDTH="191" />
                        <TBODY>
                            <TR>
                                <TD
                                    WIDTH="191"
                                    HEIGHT="4"
                                    BGCOLOR="#d2d9eb"
                                    STYLE="border: 1px solid #808080; padding: 0in 0.08in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT
                                                SIZE="2"
                                                STYLE="font-size: 9pt"
                                                ><B>CLIENT INFORMATION</B></FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                                <TD
                                    WIDTH="191"
                                    HEIGHT="4"
                                    BGCOLOR="#d2d9eb"
                                    STYLE="border: 1px solid #808080; padding: 0in 0.08in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT
                                                SIZE="2"
                                                STYLE="font-size: 9pt"
                                                ><B>AGENT INFORMATION</B></FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                            </TR>
                        </TBODY>
                        <TBODY>
                            <TR>
                                <TD
                                    WIDTH="191"
                                    HEIGHT="5"
                                    BGCOLOR="#ffffff"
                                    STYLE="border: none; padding: 0in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="2"
                                                >Recieved From:
                                                {{ receipt.receivedFrom }}</FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                                <TD
                                    WIDTH="191"
                                    HEIGHT="5"
                                    BGCOLOR="#ffffff"
                                    STYLE="border: none; padding: 0in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="2"
                                                >Captured By:
                                                {{ receipt.capturedBy }}</FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                            </TR>
                            <TR>
                                <TD
                                    WIDTH="191"
                                    HEIGHT="5"
                                    BGCOLOR="#ffffff"
                                    STYLE="border: none; padding: 0in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="2"
                                                >On Behalf Of:
                                                {{ receipt.onBehalfOf }}</FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                                <TD
                                    WIDTH="191"
                                    HEIGHT="5"
                                    BGCOLOR="#ffffff"
                                    STYLE="border: none; padding: 0in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="2"
                                                >Date Generated:
                                                {{ newDate | date }}</FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                            </TR>
                            <TR>
                                <TD
                                    WIDTH="191"
                                    HEIGHT="5"
                                    BGCOLOR="#ffffff"
                                    STYLE="border: none; padding: 0in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="2"
                                                >Date Issued:
                                                {{
                                                    receipt.todayDate | date
                                                }}</FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                                <TD
                                    WIDTH="191"
                                    HEIGHT="5"
                                    BGCOLOR="#ffffff"
                                    STYLE="border: none; padding: 0in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="2"
                                                >Source of Business:
                                                {{
                                                    receipt.sourceOfBusiness
                                                }}</FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                            </TR>
                            <TR>
                                <TD
                                    WIDTH="191"
                                    HEIGHT="5"
                                    BGCOLOR="#ffffff"
                                    STYLE="border: none; padding: 0in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="2"
                                                ></FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                                <ng-container
                                    *ngIf="
                                        receipt.sourceOfBusiness !== 'Direct'
                                    "
                                >
                                    <TD
                                        WIDTH="191"
                                        HEIGHT="5"
                                        BGCOLOR="#ffffff"
                                        STYLE="border: none; padding: 0in"
                                    >
                                        <P ALIGN="LEFT"
                                            ><FONT FACE="Arial, serif"
                                                ><FONT SIZE="2"
                                                    >Intemediary Name:
                                                    {{
                                                        receipt.intermediaryName
                                                    }}</FONT
                                                ></FONT
                                            ></P
                                        >
                                    </TD>
                                </ng-container>
                            </TR>
                            <!-- <TR>
                                <TD
                                    WIDTH="191"
                                    HEIGHT="5"
                                    BGCOLOR="#ffffff"
                                    STYLE="border: none; padding: 0in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="2"
                                                ></FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                            </TR> -->
                            <TR>
                                <TD
                                    WIDTH="191"
                                    HEIGHT="5"
                                    BGCOLOR="#ffffff"
                                    STYLE="border: none; padding: 0in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="2"
                                                >Payment Method:
                                                {{
                                                    receipt.paymentMethod
                                                }}</FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                                <ng-container
                                    *ngIf="receipt.paymentMethod === 'cheque'"
                                >
                                    <TD
                                        WIDTH="191"
                                        HEIGHT="5"
                                        BGCOLOR="#ffffff"
                                        STYLE="border: none; padding: 0in"
                                    >
                                        <P ALIGN="LEFT"
                                            ><FONT FACE="Arial, serif"
                                                ><FONT SIZE="2"
                                                    >Cheque Number:
                                                    {{
                                                        receipt.cheqNumber
                                                    }}</FONT
                                                ></FONT
                                            ></P
                                        >
                                    </TD>
                                    <TD
                                    WIDTH="191"
                                    HEIGHT="5"
                                    BGCOLOR="#ffffff"
                                    STYLE="border: none; padding: 0in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="2"
                                                ></FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>

                                </ng-container>
                            </TR>
                            <TR>

                              <TD
                              WIDTH="191"
                              HEIGHT="5"
                              BGCOLOR="#ffffff"
                              STYLE="border: none; padding: 0in"
                          >
                              <P ALIGN="LEFT"
                                  ><FONT FACE="Arial, serif"
                                      ><FONT SIZE="2"
                                          >Amount in Words:
                                          {{
                                              toWords(
                                                  receipt.sumInDigits
                                                      | number: '1.2-2'
                                              )
                                          }}</FONT
                                      ></FONT
                                  ></P
                              >
                          </TD>
                            </TR>
                        </TBODY>
                    </TABLE>
                    <P STYLE="margin-bottom: 0.11in"><BR /><BR /> </P>
                    <TABLE WIDTH="100%" CELLPADDING="7" CELLSPACING="0">
                        <COL WIDTH="162*" />
                        <COL WIDTH="39*" />
                        <COL WIDTH="54*" />
                        <TBODY>
                            <TR>
                                <TD
                                    WIDTH="63%"
                                    HEIGHT="13"
                                    BGCOLOR="#d2d9eb"
                                    STYLE="border-top: 1px solid #808080; border-bottom: 1px solid #808080; border-left: 1px solid #808080; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.08in; padding-right: 0in"
                                >
                                    <P STYLE="text-indent: 0.13in" ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT
                                                SIZE="2"
                                                STYLE="font-size: 9pt"
                                                ><B>RECEIPT TYPE</B></FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                                <TD
                                    WIDTH="15%"
                                    BGCOLOR="#d2d9eb"
                                    STYLE="border-top: 1px solid #808080; border-bottom: 1px solid #808080; border-left: none; border-right: none; padding: 0in"
                                >
                                    <P>&nbsp;</P>
                                </TD>
                                <TD
                                    WIDTH="21%"
                                    BGCOLOR="#d2d9eb"
                                    STYLE="border: 1px solid #808080; padding: 0in 0.08in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT
                                                SIZE="2"
                                                STYLE="font-size: 9pt"
                                                ><B
                                                    >AMOUNT({{
                                                        receipt.currency
                                                    }})</B
                                                ></FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                            </TR>
                        </TBODY>
                        <TBODY>
                            <TR>
                                <TD
                                    WIDTH="63%"
                                    HEIGHT="5"
                                    BGCOLOR="#ffffff"
                                    STYLE="border-top: none; border-bottom: none; border-left: 1px solid #808080; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.08in; padding-right: 0in"
                                >
                                    <P STYLE="text-indent: 0.14in">&nbsp;</P>
                                </TD>
                                <TD
                                    WIDTH="15%"
                                    BGCOLOR="#ffffff"
                                    STYLE="border: none; padding: 0in"
                                >
                                    <P STYLE="text-indent: 0.14in"><BR /> </P>
                                </TD>
                                <TD
                                    WIDTH="21%"
                                    BGCOLOR="#ffffff"
                                    STYLE="border-top: none; border-bottom: none; border-left: 1px solid #808080; border-right: 1px solid #808080; padding: 0in 0.08in"
                                >
                                    <P ALIGN="RIGHT">&nbsp;</P>
                                </TD>
                            </TR>
                            <TR>
                                <TD
                                    WIDTH="63%"
                                    HEIGHT="5"
                                    BGCOLOR="#ffffff"
                                    STYLE="border-top: none; border-bottom: none; border-left: 1px solid #808080; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.08in; padding-right: 0in"
                                >
                                    <P STYLE="text-indent: 0.14in" ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="2">{{
                                                receipt.receiptType
                                            }}</FONT></FONT
                                        ></P
                                    >
                                </TD>
                                <TD
                                    WIDTH="15%"
                                    BGCOLOR="#ffffff"
                                    STYLE="border: none; padding: 0in"
                                >
                                    <P STYLE="text-indent: 0.14in"><BR /> </P>
                                </TD>
                                <TD
                                    WIDTH="21%"
                                    BGCOLOR="#ffffff"
                                    STYLE="border-top: none; border-bottom: none; border-left: 1px solid #808080; border-right: 1px solid #808080; padding: 0in 0.08in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="2"
                                                >{{ receipt.sumInDigits |number : '1.2-2'}}
                                            </FONT></FONT
                                        >
                                    </P>
                                </TD>
                            </TR>
                        </TBODY>
                        <TBODY>
                            <TR>
                                <TD
                                    WIDTH="63%"
                                    HEIGHT="22"
                                    BGCOLOR="#ffffff"
                                    STYLE="border-top: 1px solid #808080; border-bottom: 1px solid #808080; border-left: 1px solid #808080; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.08in; padding-right: 0in"
                                >
                                    <P ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><I
                                                >Thank you for your business!</I
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                                <TD
                                    WIDTH="15%"
                                    BGCOLOR="#ffffff"
                                    STYLE="border-top: 1px solid #808080; border-bottom: 1px solid #808080; border-left: 1px solid #808080; border-right: none; padding-top: 0in; padding-bottom: 0in; padding-left: 0.08in; padding-right: 0in"
                                >
                                    <P STYLE="text-indent: 0.2in" ALIGN="LEFT"
                                        ><FONT FACE="Arial, serif"
                                            ><FONT SIZE="4"
                                                ><B>TOTAL</B></FONT
                                            ></FONT
                                        ></P
                                    >
                                </TD>
                                <TD
                                    WIDTH="21%"
                                    BGCOLOR="#ffffff"
                                    STYLE="border-top: 1px solid #808080; border-bottom: 1px solid #808080; border-left: none; border-right: 1px solid #808080; padding-top: 0in; padding-bottom: 0in; padding-left: 0in; padding-right: 0.08in"
                                >
                                    <P ALIGN="LEFT">
                                        <FONT FACE="Arial, serif"
                                            ><FONT SIZE="3"
                                                ><B
                                                    >{{ receipt.currency }}
                                                    {{ receipt.sumInDigits |number : '1.2-2' }}
                                                </B></FONT
                                            ></FONT
                                        >
                                    </P>
                                </TD>
                            </TR>
                        </TBODY>
                    </TABLE>
                    <table>
                        <tr>
                            <TD
                                ><P ALIGN="LEFT">
                                    <FONT FACE="Arial, serif"
                                        ><FONT SIZE="3"
                                            >Narration:
                                            {{ receipt.narration }}</FONT
                                        ></FONT
                                    >
                                </P></TD
                            >
                        </tr>
                        <tr>
                            <TD
                                ><P ALIGN="LEFT">
                                    <FONT FACE="Arial, serif"
                                        ><FONT SIZE="3"
                                            >Remarks:
                                            {{ receipt.remarks }}</FONT
                                        ></FONT
                                    >
                                </P></TD
                            >
                        </tr>
                    </table>
                    <!-- <P STYLE="margin-bottom: 0.11in"><BR /><BR /> </P>
                    <P STYLE="margin-bottom: 0.11in"><BR /><BR /> </P> -->
                    <P ALIGN="CENTER" STYLE="margin-bottom: 0in"
                        >If you have any questions about this receipt, please
                        contact</P
                    >
                    <P ALIGN="CENTER" STYLE="margin-bottom: 0.11in"
                        >phone: +260 211 239865/6, email:
                        info@aplusgeneral.com</P
                    >
                </div>
            </nz-spin>
            <!-- <pdf-viewer #page [src]="receiptURl" [original-size]="false"></pdf-viewer> -->
        </nz-card>
    </div>
</nz-spin>
