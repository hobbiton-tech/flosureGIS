<nz-spin
    nzSize="large"
    nzTip="Underwriting Report Loading...."
    [nzSpinning]="isOkLoading"
>
    <div style="background: #ececec; padding: 30px;">
        <div nz-row [nzGutter]="8">
            <div nz-col [nzSpan]="8">
                <nz-card [nzTitle]="'Quotation Report'" [nzHoverable]="true">
                    <button
                        nz-button
                        [nzType]="'default'"
                        (click)="showModal()"
                    >
                        Quotation Listing Report
                    </button>
                    <!-- <br />
                <br /> -->

                    <!-- <button
                    nz-button
                    [nzType]="'default'"
                    (click)="showAnalysisReportModal()"
                >
                    Quotation Analysis Report
                </button> -->
                    <br />
                    <br />
                    <button
                        nz-button
                        [nzType]="'default'"
                        (click)="showIntermediaryModal()"
                    >
                        Intermediary Quotation Listing Report
                    </button>
                </nz-card>
            </div>
            <div nz-col [nzSpan]="8">
                <nz-card [nzTitle]="'Renewal Report'" [nzHoverable]="true">
                    <button
                        nz-button
                        [nzType]="'default'"
                        (click)="showRenewalReportModal()"
                    >
                        Renewal List
                    </button>
                </nz-card>
            </div>
            <div nz-col [nzSpan]="8">
                <nz-card
                    [nzTitle]="'Premium Production Report'"
                    [nzHoverable]="true"
                >
                    <button
                        nz-button
                        [nzType]="'default'"
                        (click)="showDebitNoteReportModal()"
                    >
                        Debit Note Listing Report
                    </button>
                    <br /><br />
                    <button
                        nz-button
                        [nzType]="'default'"
                        (click)="showProductionReportModal()"
                    >
                        Production Report
                    </button>
                    <br />
                    <br />
                    <button
                        nz-button
                        [nzType]="'default'"
                        (click)="showPremiumWorkingReportModal()"
                    >
                        Premium Working Report
                    </button>
                </nz-card>
            </div>
        </div>

        <nz-modal
            [(nzVisible)]="isVisible"
            nzTitle=" Quotation Listing Report"
            (nzOnCancel)="handleCancel()"
            [nzWidth]="'auto'"
            (nzOnOk)="handleOk()"
        >
            <div style="margin: 20px;">
                <nz-card>
                    <div style="margin-bottom: 20px;">
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="14">
                                <form nz-form [formGroup]="filterForm">
                                    <nz-row>
                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="fromDate"
                                                    nzRequired
                                                    >From Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #fromDate
                                                        formControlName="fromDate"
                                                        name="fromDate"
                                                        id="fromDate"
                                                        placeholder="From date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>

                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="toDate"
                                                    nzRequired
                                                    >End Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #toDate
                                                        formControlName="toDate"
                                                        name="toDate"
                                                        id="toDate"
                                                        placeholder="To Date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                        <div
                                            nz-col
                                            [nzSpan]="4"
                                            style="float: left;"
                                        >
                                            <nz-form-item>
                                                <nz-form-control [nzSpan]="4">
                                                    <button
                                                        nz-button
                                                        nzType="success"
                                                        (click)="
                                                            _getFilterReportList(
                                                                filterForm.value
                                                            )
                                                        "
                                                    >
                                                        Submit
                                                    </button>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                    </nz-row>
                                </form>
                            </div>

                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    nzType="primary"
                                    (click)="downloadQuotationReportListExcel()"
                                >
                                    Export EXCEL
                                </button>
                            </div>
                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    (click)="
                                        downloadPDF(
                                            'Table',
                                            'Quotation Listing Report'
                                        )
                                    "
                                    nzType="danger"
                                >
                                    Export PDF
                                </button>
                            </div>
                        </nz-row>

                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="18">
                                <nz-input-group [nzSuffix]="suffixIconSearch">
                                    <input
                                        type="text"
                                        nz-input
                                        placeholder="Search by branch"
                                        [(ngModel)]="searchString"
                                        (ngModelChange)="search($event)"
                                    />
                                </nz-input-group>
                                <ng-template #suffixIconSearch>
                                    <i nz-icon nzType="search"></i>
                                </ng-template>
                            </div>
                            <div nz-col [nzSpan]="6" style="float: right;">
                                <nz-input-group>
                                    <nz-select
                                        nzShowSearch
                                        nzAllowClear
                                        nzPlaceHolder="Select Intermediary Type"
                                    >
                                        <nz-option
                                            nzLabel="All"
                                            nzValue="All"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Agent"
                                            nzValue="Broker"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Broker"
                                            nzValue="Broker"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Sale Representative"
                                            nzValue="Sale Representative"
                                        ></nz-option>
                                    </nz-select>
                                </nz-input-group>
                            </div>
                        </nz-row>

                        <nz-table
                            id="Table"
                            #reportsTable
                            [nzData]="displayedMotor"
                            [nzSize]="'small'"
                            [nzBordered]="true"
                            style="background-color: white;"
                        >
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Quotation Number</th>
                                    <th>Client</th>
                                    <th>Transaction Date</th>
                                    <th>Underwriter</th>
                                    <th>Intermediary</th>
                                    <th>Branch</th>
                                    <th>Source of Business</th>
                                    <th>Product</th>
                                    <th>Sum Insured</th>
                                    <th>Premium</th>
                                    <th>Status</th>
                                </tr>
                            </thead>

                            <tbody>
                                <tr
                                    *ngFor="
                                        let report of reportsTable.data;
                                        let i = index
                                    "
                                >
                                    <td>{{ i + 1 }}</td>
                                    <td>{{ report.quoteNumber }}</td>
                                    <td>{{ report.client }}</td>
                                    <td>{{ report.dateCreated | date }}</td>
                                    <td>
                                        {{
                                            report
                                                ? report.getBranch[0].firstName
                                                    ? report.getBranch[0]
                                                          .firstName
                                                    : ''
                                                : ''
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            report.intermediaryName
                                                ? report.intermediaryName
                                                : 'direct'
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            report
                                                ? report.getBranch[0].branch
                                                    ? report.getBranch[0].branch
                                                    : ''
                                                : ''
                                        }}
                                    </td>
                                    <!-- <td>{{ report.getBranch[0].branch ? report.getBranch[0].branch : '' }}</td> -->
                                    <td>{{ report.sourceOfBusiness }}</td>
                                    <td>{{ 'Motor' }}</td>
                                    <td>
                                        {{
                                            report.sumInsured | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            report.grossPremium
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        <nz-badge
                                            [nzStatus]="
                                                report.status === 'Draft'
                                                    ? 'warning'
                                                    : 'success'
                                            "
                                            [nzText]="report.status"
                                        ></nz-badge>
                                    </td>
                                </tr>
                                <tr>
                                    <td>{{ 'TOTAL' }}</td>
                                    <td>{{ '' }}</td>
                                    <td>{{ '' }}</td>
                                    <td>{{ '' }}</td>
                                    <td>{{ '' }}</td>
                                    <td>
                                        {{ '' }}
                                    </td>
                                    <td>{{ '' }}</td>
                                    <td>{{ '' }}</td>
                                    <td>{{ '' }}</td>
                                    <td>
                                        {{
                                            getSumMotor('sumInsured')
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            getSumMotor('grossPremium')
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </nz-table>
                    </div>
                </nz-card>
            </div>
        </nz-modal>

        <nz-modal
            [(nzVisible)]="isIntermediaryQuotationListingReport"
            nzTitle=" Intermediary Quotation Listing Report"
            (nzOnCancel)="handleCancel()"
            [nzWidth]="'auto'"
            (nzOnOk)="handleOk()"
        >
            <div style="margin: 20px;">
                <nz-card>
                    <div style="margin-bottom: 20px;">
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="14">
                                <form nz-form [formGroup]="filterForm">
                                    <nz-row>
                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="fromDate"
                                                    nzRequired
                                                    >From Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #fromDate
                                                        formControlName="fromDate"
                                                        name="fromDate"
                                                        id="fromDate"
                                                        placeholder="From date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>

                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="toDate"
                                                    nzRequired
                                                    >End Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #toDate
                                                        formControlName="toDate"
                                                        name="toDate"
                                                        id="toDate"
                                                        placeholder="To Date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                        <div
                                            nz-col
                                            [nzSpan]="4"
                                            style="float: left;"
                                        >
                                            <nz-form-item>
                                                <nz-form-control [nzSpan]="4">
                                                    <button
                                                        nz-button
                                                        nzType="success"
                                                        (click)="
                                                            _getFilterReportList(
                                                                filterForm.value
                                                            )
                                                        "
                                                    >
                                                        Submit
                                                    </button>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                    </nz-row>
                                </form>
                            </div>

                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    nzType="primary"
                                    (click)="downloadQuotationReportListExcel()"
                                >
                                    Export EXCEL
                                </button>
                            </div>
                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    (click)="
                                        downloadPDF(
                                            'Table',
                                            'Intermediary Quotation Listing Report'
                                        )
                                    "
                                    nzType="danger"
                                >
                                    Export PDF
                                </button>
                            </div>
                        </nz-row>
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="18">
                                <nz-input-group [nzSuffix]="suffixIconSearch">
                                    <input
                                        type="text"
                                        nz-input
                                        placeholder="Search by branch"
                                        [(ngModel)]="searchString"
                                        (ngModelChange)="search($event)"
                                    />
                                </nz-input-group>
                                <ng-template #suffixIconSearch>
                                    <i nz-icon nzType="search"></i>
                                </ng-template>
                            </div>
                            <div nz-col [nzSpan]="6" style="float: right;">
                                <nz-input-group>
                                    <nz-select
                                        style="width: 200px;"
                                        nzShowSearch
                                        nzAllowClear
                                        nzPlaceHolder="Select Intermediary type."
                                    >
                                        <nz-option
                                            nzLabel="All"
                                            nzValue="All"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Sales Representative"
                                            nzValue="Sales Representative"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Agent"
                                            nzValue="Agent"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Broker"
                                            nzValue="Broker"
                                        ></nz-option>
                                    </nz-select>
                                </nz-input-group>
                            </div>
                        </nz-row>

                        <nz-table
                            id="Table"
                            #intermediaryTable
                            [nzData]="displayedFilterMotor"
                            [nzSize]="'small'"
                            [nzBordered]="true"
                            style="background-color: white;"
                        >
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Quotation Number</th>
                                    <th>Client</th>
                                    <th>Transaction Date</th>
                                    <th>Underwriter</th>
                                    <th>Intermediary</th>
                                    <th>Branch</th>
                                    <th>Source of Business</th>
                                    <th>Product</th>
                                    <th>Sum Insured</th>
                                    <th>Premium</th>
                                    <th>Status</th>
                                </tr>
                            </thead>

                            <tbody>
                                <tr
                                    *ngFor="
                                        let report of intermediaryTable.data;
                                        let i = index
                                    "
                                >
                                    <td>{{ i + 1 }}</td>
                                    <td>{{ report.quoteNumber }}</td>
                                    <td>{{ report.client }}</td>
                                    <td>{{ report.dateCreated | date }}</td>
                                    <!-- <td>{{ getEmailName(report.user) }}</td> -->
                                    <td>
                                        {{
                                            report
                                                ? report.getBranch[0].firstName
                                                    ? report.getBranch[0]
                                                          .firstName
                                                    : ''
                                                : ''
                                        }}
                                    </td>
                                    <td>{{ report.intermediaryName }}</td>
                                    <td>{{ report.getBranch[0].branch }}</td>
                                    <td>{{ report.sourceOfBusiness }}</td>
                                    <td>{{ 'Motor' }}</td>
                                    <td>
                                        {{
                                            report.sumInsured | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            report.grossPremium
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        <nz-badge
                                            [nzStatus]="
                                                report.status === 'Draft'
                                                    ? 'warning'
                                                    : 'success'
                                            "
                                            [nzText]="report.status"
                                        ></nz-badge>
                                    </td>
                                </tr>
                                <tr>
                                    <td>{{ 'TOTAL' }}</td>
                                    <td>{{ '' }}</td>
                                    <td>{{ '' }}</td>
                                    <td>{{ '' }}</td>
                                    <td>{{ '' }}</td>
                                    <td>
                                        {{ '' }}
                                    </td>
                                    <td>{{ '' }}</td>
                                    <td>{{ '' }}</td>
                                    <td>{{ '' }}</td>
                                    <td>
                                        {{
                                            getSumMotor('sumInsured')
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            getSumMotor('grossPremium')
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </nz-table>
                    </div>
                </nz-card>
            </div>
        </nz-modal>

        <nz-modal
            [(nzVisible)]="isAnalysisReportVisible"
            nzTitle="Quotation Analysis Report"
            (nzOnCancel)="handleCancel()"
            [nzWidth]="1200"
            (nzOnOk)="handleOk()"
        >
            <div style="margin: 20px;">
                <nz-card>
                    <div style="margin-bottom: 20px;">
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="14">
                                <form nz-form [formGroup]="filterForm">
                                    <nz-row>
                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="fromDate"
                                                    nzRequired
                                                    >From Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #fromDate
                                                        formControlName="fromDate"
                                                        name="fromDate"
                                                        id="fromDate"
                                                        placeholder="From date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>

                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="toDate"
                                                    nzRequired
                                                    >End Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #toDate
                                                        formControlName="toDate"
                                                        name="toDate"
                                                        id="toDate"
                                                        placeholder="To Date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                        <div
                                            nz-col
                                            [nzSpan]="4"
                                            style="float: left;"
                                        >
                                            <nz-form-item>
                                                <nz-form-control [nzSpan]="4">
                                                    <button
                                                        nz-button
                                                        nzType="success"
                                                        (click)="
                                                            _getFilterReportList(
                                                                filterForm.value
                                                            )
                                                        "
                                                    >
                                                        Submit
                                                    </button>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                    </nz-row>
                                </form>
                            </div>

                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    nzType="primary"
                                    (click)="downloadQuotationReportListExcel()"
                                >
                                    Export Excel
                                </button>
                            </div>
                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    (click)="
                                        downloadPDF(
                                            'Table',
                                            'Quotation Analysis Report'
                                        )
                                    "
                                    nzType="danger"
                                >
                                    Export PDF
                                </button>
                            </div>
                        </nz-row>
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="18">
                                <nz-input-group [nzSuffix]="suffixIconSearch">
                                    <input
                                        type="text"
                                        nz-input
                                        placeholder="Search by client, First Name, Last Name"
                                        [(ngModel)]="searchString"
                                        (ngModelChange)="search($event)"
                                    />
                                </nz-input-group>
                                <ng-template #suffixIconSearch>
                                    <i nz-icon nzType="search"></i>
                                </ng-template>
                            </div>
                            <div nz-col [nzSpan]="6" style="float: right;">
                                <nz-input-group>
                                    <nz-select
                                        style="width: 200px;"
                                        nzShowSearch
                                        nzAllowClear
                                        nzPlaceHolder="Select client type."
                                    >
                                        <nz-option
                                            nzLabel="All"
                                            nzValue="All"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Sales Representative"
                                            nzValue="Sales Representative"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Agent"
                                            nzValue="Agent"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Broker"
                                            nzValue="Broker"
                                        ></nz-option>
                                    </nz-select>
                                </nz-input-group>
                            </div>
                        </nz-row>

                        <nz-table
                            id="Table"
                            #analysisTable
                            [nzData]=""
                            [nzSize]="'small'"
                            [nzBordered]="true"
                            style="background-color: white;"
                        >
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Branch</th>
                                    <th>Intermediary Name</th>
                                    <th>Number of Quotation</th>
                                    <th>Number Converted</th>
                                    <th>Acquisition Ratio</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <!-- <td>{{ i + 1 }}</td>
                                <td>{{ 'Branch' }}</td>
                                <td>{{ intermediary.getFullName }}</td>
                                <td>
                                    {{ intermediary.getQuoteCount }}
                                </td>
                                <td>
                                    {{ intermediary.getPolicyCount }}
                                </td>
                                <td>{{ intermediary.getRatio }}</td> -->
                                </tr>
                            </tbody>
                        </nz-table>
                    </div>
                </nz-card>
            </div>
        </nz-modal>

        <!-- Renewal Report -->
        <nz-modal
            [(nzVisible)]="isRenewalReportVisible"
            nzTitle="Renewal Report"
            (nzOnCancel)="handleCancel()"
            [nzWidth]="1000"
            (nzOnOk)="handleOk()"
        >
            <div style="margin: 20px;">
                <nz-card>
                    <div style="margin-bottom: 20px;">
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="14">
                                <form nz-form [formGroup]="filterForm">
                                    <nz-row>
                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="fromDate"
                                                    nzRequired
                                                    >From Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #fromDate
                                                        formControlName="fromDate"
                                                        name="fromDate"
                                                        id="fromDate"
                                                        placeholder="From date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>

                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="toDate"
                                                    nzRequired
                                                    >End Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #toDate
                                                        formControlName="toDate"
                                                        name="toDate"
                                                        id="toDate"
                                                        placeholder="To Date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                        <div
                                            nz-col
                                            [nzSpan]="4"
                                            style="float: left;"
                                        >
                                            <nz-form-item>
                                                <nz-form-control [nzSpan]="4">
                                                    <button
                                                        nz-button
                                                        nzType="success"
                                                        (click)="
                                                            _getFilterReportList(
                                                                filterForm.value
                                                            )
                                                        "
                                                    >
                                                        Submit
                                                    </button>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                    </nz-row>
                                </form>
                            </div>

                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    nzType="primary"
                                    (click)="downloadQuotationReportListExcel()"
                                >
                                    Export Excel
                                </button>
                            </div>
                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    (click)="
                                        downloadPDF('Table', 'Renewal Report')
                                    "
                                    nzType="danger"
                                >
                                    Export PDF
                                </button>
                            </div>
                        </nz-row>
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="18">
                                <nz-input-group [nzSuffix]="suffixIconSearch">
                                    <input
                                        type="text"
                                        nz-input
                                        placeholder="Search by client, First Name, Last Name"
                                        [(ngModel)]="searchString"
                                        (ngModelChange)="search($event)"
                                    />
                                </nz-input-group>
                                <ng-template #suffixIconSearch>
                                    <i nz-icon nzType="search"></i>
                                </ng-template>
                            </div>
                            <div nz-col [nzSpan]="6" style="float: right;">
                                <nz-input-group>
                                    <nz-select
                                        style="width: 200px;"
                                        nzShowSearch
                                        nzAllowClear
                                        nzPlaceHolder="Select client type."
                                    >
                                        <nz-option
                                            nzLabel="All"
                                            nzValue="All"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Sales Representative"
                                            nzValue="Sales Representative"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Agent"
                                            nzValue="Agent"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Broker"
                                            nzValue="Broker"
                                        ></nz-option>
                                    </nz-select>
                                </nz-input-group>
                            </div>
                        </nz-row>

                        <nz-table
                            id="Table"
                            #renewalTable
                            [nzData]="displayPremiumReport"
                            [nzSize]="'small'"
                            [nzBordered]="true"
                            style="background-color: white;"
                        >
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Policy number</th>
                                    <th>Client</th>
                                    <th>Intermediary</th>
                                    <!-- <th>Contact number</th> -->
                                    <th>Renewal date</th>
                                    <th>Renewal premium due</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr
                                    *ngFor="
                                        let renewal of renewalTable.data;
                                        let i = index
                                    "
                                    style="cursor: pointer;"
                                >
                                    <td>{{ i + 1 }}</td>
                                    <td>{{ renewal.policyNumber }}</td>
                                    <td>{{ renewal.client }}</td>
                                    <td>
                                        {{
                                            renewal.intermediaryName
                                                ? renewal.intermediaryName
                                                : 'direct'
                                        }}
                                    </td>
                                    <!-- <td>{{ renewal.clientCode }}</td> -->
                                    <td>{{ renewal.expiryDate | date }}</td>
                                    <td>
                                        {{
                                            renewal.sumInsured | number: '1.2-2'
                                        }}
                                    </td>
                                </tr>
                                <tr
                                    *ngFor="
                                        let renewal of renewalTable.data;
                                        let i = index
                                    "
                                    style="cursor: pointer;"
                                >
                                    <td>{{ i + 1 }}</td>
                                    <td>{{ renewal.policyNumber }}</td>
                                    <td>{{ renewal.client }}</td>
                                    <td>
                                        {{
                                            renewal.intermediaryName
                                                ? renewal.intermediaryName
                                                : 'direct'
                                        }}
                                    </td>
                                    <!-- <td>{{ renewal.clientCode }}</td> -->
                                    <td>{{ renewal.expiryDate | date }}</td>
                                    <td>
                                        {{
                                            renewal.sumInsured | number: '1.2-2'
                                        }}
                                    </td>
                                </tr>
                                <tr>
                                    <td>{{ 'Total' }}</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td>
                                        {{
                                            getSum('sumInsured')
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                </tr>
                            </tbody>
                        </nz-table>
                    </div>
                </nz-card>
            </div>
        </nz-modal>

        <!-- Underwriting Report -->

        <!-- Premium Working Report  -->
        <nz-modal
            [(nzVisible)]="isPremiumWorkingReportVisible"
            nzTitle="Premium Working Report "
            (nzOnCancel)="handleCancel()"
            [nzWidth]="1000"
            (nzOnOk)="handleOk()"
        >
            <div style="margin: 20px;">
                <nz-card>
                    <div style="margin-bottom: 20px;">
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="14">
                                <form nz-form [formGroup]="filterForm">
                                    <nz-row>
                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="fromDate"
                                                    nzRequired
                                                    >From Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #fromDate
                                                        formControlName="fromDate"
                                                        name="fromDate"
                                                        id="fromDate"
                                                        placeholder="From date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>

                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="toDate"
                                                    nzRequired
                                                    >End Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #toDate
                                                        formControlName="toDate"
                                                        name="toDate"
                                                        id="toDate"
                                                        placeholder="To Date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                        <div
                                            nz-col
                                            [nzSpan]="4"
                                            style="float: left;"
                                        >
                                            <nz-form-item>
                                                <nz-form-control [nzSpan]="4">
                                                    <button
                                                        nz-button
                                                        nzType="success"
                                                        (click)="
                                                            _getFilterReportList(
                                                                filterForm.value
                                                            )
                                                        "
                                                    >
                                                        Submit
                                                    </button>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                    </nz-row>
                                </form>
                            </div>

                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    nzType="primary"
                                    (click)="downloadQuotationReportListExcel()"
                                >
                                    Export Excel
                                </button>
                            </div>
                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    (click)="
                                        downloadPDF(
                                            'Table',
                                            'Premium Working Report'
                                        )
                                    "
                                    nzType="danger"
                                >
                                    Export PDF
                                </button>
                            </div>
                        </nz-row>
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="18">
                                <nz-input-group [nzSuffix]="suffixIconSearch">
                                    <input
                                        type="text"
                                        nz-input
                                        placeholder="Search by client, First Name, Last Name"
                                        [(ngModel)]="searchString"
                                        (ngModelChange)="search($event)"
                                    />
                                </nz-input-group>
                                <ng-template #suffixIconSearch>
                                    <i nz-icon nzType="search"></i>
                                </ng-template>
                            </div>
                            <div nz-col [nzSpan]="6" style="float: right;">
                                <nz-input-group>
                                    <nz-select
                                        style="width: 200px;"
                                        nzShowSearch
                                        nzAllowClear
                                        nzPlaceHolder="Select client type."
                                    >
                                        <nz-option
                                            nzLabel="All"
                                            nzValue="All"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Sales Representative"
                                            nzValue="Sales Representative"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Agent"
                                            nzValue="Agent"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Broker"
                                            nzValue="Broker"
                                        ></nz-option>
                                    </nz-select>
                                </nz-input-group>
                            </div>
                        </nz-row>

                        <nz-table
                            id="Table"
                            #premiumWorkingTable
                            [nzData]="displayPremiumReport"
                            [nzSize]="'small'"
                            [nzBordered]="true"
                            style="background-color: white;"
                        >
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Policy Number</th>
                                    <th>Debit note number</th>
                                    <th>Gross Premium</th>
                                    <th>Discount</th>
                                    <th>Loading</th>
                                    <th>Net Premium</th>
                                    <th>Insurance Levy</th>
                                    <th>Premium Due</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr
                                    *ngFor="
                                        let production of premiumWorkingTable.data;
                                        let i = index
                                    "
                                    style="cursor: pointer;"
                                >
                                    <td>{{ i + 1 }}</td>

                                    <td>{{ production.policyNumber }}</td>
                                    <td>{{ production.debitNoteNumber }}</td>
                                    <td>{{ production.grossPremium }}</td>
                                    <td>
                                        {{
                                            production.discount
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            production.loading | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            production.netPremium
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{ production.levy | number: '1.2-2' }}
                                    </td>
                                    <td>
                                        {{
                                            production.sumInsured
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                </tr>
                                <tr>
                                    <td>{{ 'Total' }}</td>
                                    <td></td>
                                    <td></td>
                                    <td>
                                        {{
                                            getSum('discount') | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            getSum('loading') | number: '1.2-2'
                                        }}
                                        <!-- {{ production.loading | number: '1.2-2' }} -->
                                    </td>
                                    <td>
                                        {{ getSum('levy') | number: '1.2-2' }}
                                        <!-- {{ production.levy | number: '1.2-2' }} -->
                                    </td>
                                    <td>
                                        {{
                                            getSum('grossPremium')
                                                | number: '1.2-2'
                                        }}
                                        <!-- {{ production.grossPremium }} -->
                                    </td>
                                    <td>
                                        {{
                                            getSum('netPremium')
                                                | number: '1.2-2'
                                        }}
                                    </td>

                                    <td>
                                        {{
                                            getSum('sumInsured')
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                </tr>
                            </tbody>
                        </nz-table>
                    </div>
                </nz-card>
            </div>
        </nz-modal>

        <!-- debit note report -->
        <nz-modal
            [(nzVisible)]="isDebitNoteReportVisible"
            nzTitle="Debit Note Report"
            (nzOnCancel)="handleCancel()"
            [nzWidth]="'auto'"
            (nzOnOk)="handleOk()"
        >
            <div style="margin: 20px;">
                <nz-card>
                    <div style="margin-bottom: 20px;">
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="14">
                                <form nz-form [formGroup]="filterForm">
                                    <nz-row>
                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="fromDate"
                                                    nzRequired
                                                    >From Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #fromDate
                                                        formControlName="fromDate"
                                                        name="fromDate"
                                                        id="fromDate"
                                                        placeholder="From date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>

                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="toDate"
                                                    nzRequired
                                                    >End Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #toDate
                                                        formControlName="toDate"
                                                        name="toDate"
                                                        id="toDate"
                                                        placeholder="To Date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                        <div
                                            nz-col
                                            [nzSpan]="4"
                                            style="float: left;"
                                        >
                                            <nz-form-item>
                                                <nz-form-control [nzSpan]="4">
                                                    <button
                                                        nz-button
                                                        nzType="success"
                                                        (click)="
                                                            _getFilterReportList(
                                                                filterForm.value
                                                            )
                                                        "
                                                    >
                                                        Submit
                                                    </button>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                    </nz-row>
                                </form>
                            </div>

                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    nzType="primary"
                                    (click)="downloadQuotationReportListExcel()"
                                >
                                    Export Excel
                                </button>
                            </div>
                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    (click)="
                                        downloadPDF(
                                            'Table',
                                            'Debit Note Report'
                                        )
                                    "
                                    nzType="danger"
                                >
                                    Export PDF
                                </button>
                            </div>
                        </nz-row>
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="18">
                                <nz-input-group [nzSuffix]="suffixIconSearch">
                                    <input
                                        type="text"
                                        nz-input
                                        placeholder="Search by client, First Name, Last Name"
                                        [(ngModel)]="searchString"
                                        (ngModelChange)="search($event)"
                                    />
                                </nz-input-group>
                                <ng-template #suffixIconSearch>
                                    <i nz-icon nzType="search"></i>
                                </ng-template>
                            </div>
                            <div nz-col [nzSpan]="6" style="float: right;">
                                <nz-input-group>
                                    <nz-select
                                        style="width: 200px;"
                                        nzShowSearch
                                        nzAllowClear
                                        nzPlaceHolder="Select client type."
                                    >
                                        <nz-option
                                            nzLabel="All"
                                            nzValue="All"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Sales Representative"
                                            nzValue="Sales Representative"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Agent"
                                            nzValue="Agent"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Broker"
                                            nzValue="Broker"
                                        ></nz-option>
                                    </nz-select>
                                </nz-input-group>
                            </div>
                        </nz-row>

                        <nz-table
                            id="Table"
                            #debitNoteReportTable
                            [nzData]="productionReport"
                            [nzSize]="'small'"
                            [nzPageSize]="50"
                            style="background-color: white;"
                        >
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Dr</th>
                                    <th>Policy number</th>
                                    <th>Client</th>
                                    <th>Intermediary</th>
                                    <th>Transaction Date</th>
                                    <th>Underwriter</th>
                                    <th>Branch</th>
                                    <th>Class</th>
                                    <th>Product</th>
                                    <th>Sum Insured</th>
                                    <th>Premium</th>
                                    <th>Levy</th>
                                    <th>Commission</th>
                                    <th>Currency</th>
                                    <th>Endor.Type</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr
                                    *ngFor="
                                        let production of debitNoteReportTable.data;
                                        let i = index
                                    "
                                    style="cursor: pointer;"
                                >
                                    <td>{{ i + 1 }}</td>
                                    <td>{{ production.debitNoteNumber }}</td>
                                    <td>{{ production.policyNumber }}</td>
                                    <td>{{ production.client }}</td>
                                    <td>
                                        {{
                                            production.intermediaryName
                                                ? production.intermediaryName
                                                : 'direct'
                                        }}
                                    </td>
                                    <td>
                                        {{ production.startDate | date }}
                                    </td>
                                    <td>
                                        {{
                                            production
                                                ? production.getBranch[0]
                                                      .firstName +
                                                  ' ' +
                                                  production.getBranch[0]
                                                      .surname
                                                    ? production.getBranch[0]
                                                          .surname +
                                                      ' ' +
                                                      production.getBranch[0]
                                                          .surname
                                                    : ''
                                                : ''
                                        }}
                                    </td>

                                    <td>
                                        {{
                                            production
                                                ? production.getBranch[0].branch
                                                    ? production.getBranch[0]
                                                          .branch
                                                    : ''
                                                : ''
                                        }}
                                    </td>
                                    <td>
                                        {{ 'Motor' }}
                                    </td>
                                    <td>
                                        {{ production.risks[0].insuranceType }}
                                    </td>
                                    <td>
                                        {{
                                            production.sumInsured
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            production.netPremium
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{ production.levy | number: '1.2-2' }}
                                    </td>
                                    <td>
                                        {{
                                            production.netPremium * 0.14
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>{{ production.currency }}</td>
                                    <td>{{ 'New Business' }}</td>
                                </tr>
                                <tr>
                                    <td>{{ 'Total' }}</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td>
                                        {{
                                            getSum('sumInsured')
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            getSum('netPremium')
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{ getSum('levy') | number: '1.2-2' }}
                                    </td>
                                    <td>
                                        {{
                                            getSum('netPremium') * 0.14
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td></td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </nz-table>
                    </div>
                </nz-card>
            </div>
        </nz-modal>

        <!-- production report -->
        <nz-modal
            [(nzVisible)]="isProductionReportVisible"
            nzTitle="Production Report"
            (nzOnCancel)="handleCancel()"
            [nzWidth]="'auto'"
            (nzOnOk)="handleOk()"
        >
            <div style="margin: 20px;">
                <nz-card>
                    <div style="margin-bottom: 20px;">
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="14">
                                <form nz-form [formGroup]="filterForm">
                                    <nz-row>
                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="fromDate"
                                                    nzRequired
                                                    >From Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #fromDate
                                                        formControlName="fromDate"
                                                        name="fromDate"
                                                        id="fromDate"
                                                        placeholder="From date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>

                                        <div nz-col [nzSpan]="10">
                                            <nz-form-item>
                                                <nz-form-label
                                                    [nzSpan]="8"
                                                    nzFor="toDate"
                                                    nzRequired
                                                    >End Date</nz-form-label
                                                >
                                                <nz-form-control [nzSpan]="14">
                                                    <nz-date-picker
                                                        #toDate
                                                        formControlName="toDate"
                                                        name="toDate"
                                                        id="toDate"
                                                        placeholder="To Date"
                                                    ></nz-date-picker>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                        <div
                                            nz-col
                                            [nzSpan]="4"
                                            style="float: left;"
                                        >
                                            <nz-form-item>
                                                <nz-form-control [nzSpan]="4">
                                                    <button
                                                        nz-button
                                                        nzType="success"
                                                        (click)="
                                                            _getFilterReportList(
                                                                filterForm.value
                                                            )
                                                        "
                                                    >
                                                        Submit
                                                    </button>
                                                </nz-form-control>
                                            </nz-form-item>
                                        </div>
                                    </nz-row>
                                </form>
                            </div>

                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    nzType="primary"
                                    (click)="downloadQuotationReportListExcel()"
                                >
                                    Export Excel
                                </button>
                            </div>
                            <div nz-col [nzSpan]="3" style="float: right;">
                                <button
                                    nz-button
                                    (click)="
                                        downloadPDF(
                                            'Table',
                                            'Production Report'
                                        )
                                    "
                                    nzType="danger"
                                >
                                    Export PDF
                                </button>
                            </div>
                        </nz-row>
                        <nz-row style="margin-bottom: 20px;" [nzGutter]="20">
                            <div nz-col [nzSpan]="18">
                                <nz-input-group [nzSuffix]="suffixIconSearch">
                                    <input
                                        type="text"
                                        nz-input
                                        placeholder="Search by client, First Name, Last Name"
                                        [(ngModel)]="searchString"
                                        (ngModelChange)="search($event)"
                                    />
                                </nz-input-group>
                                <ng-template #suffixIconSearch>
                                    <i nz-icon nzType="search"></i>
                                </ng-template>
                            </div>
                            <div nz-col [nzSpan]="6" style="float: right;">
                                <nz-input-group>
                                    <nz-select
                                        style="width: 200px;"
                                        nzShowSearch
                                        nzAllowClear
                                        nzPlaceHolder="Select client type."
                                    >
                                        <nz-option
                                            nzLabel="All"
                                            nzValue="All"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Sales Representative"
                                            nzValue="Sales Representative"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Agent"
                                            nzValue="Agent"
                                        ></nz-option>
                                        <nz-option
                                            nzLabel="Broker"
                                            nzValue="Broker"
                                        ></nz-option>
                                    </nz-select>
                                </nz-input-group>
                            </div>
                        </nz-row>

                        <nz-table
                            id="Table"
                            #productionTable
                            [nzData]="productionReport"
                            [nzSize]="'small'"
                            [nzBordered]="true"
                            [nzPageSize]="50"
                            style="background-color: white;"
                        >
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>PolicyNumber</th>
                                    <th>Client</th>
                                    <th>Intermediary</th>
                                    <th>TransactionDate</th>
                                    <th>Underwriter</th>
                                    <th>Branch</th>
                                    <th>Class</th>
                                    <th>Product</th>
                                    <th>SumInsured</th>
                                    <th>Premium</th>
                                    <th>Levy</th>
                                    <th>Commission</th>
                                    <th>Currency</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr
                                    *ngFor="
                                        let production of productionTable.data;
                                        let i = index
                                    "
                                    style="cursor: pointer;"
                                >
                                    <td>{{ i + 1 }}</td>
                                    <td>{{ production.policyNumber }}</td>
                                    <td>{{ production.client }}</td>
                                    <td>
                                        {{
                                            production.intermediaryName
                                                ? production.intermediaryName
                                                : 'direct'
                                        }}
                                    </td>
                                    <td>{{ production.startDate | date }}</td>

                                    <td>
                                        {{
                                            production
                                                ? production.getBranch[0]
                                                      .firstName +
                                                  ' ' +
                                                  production.getBranch[0]
                                                      .surname
                                                    ? production.getBranch[0]
                                                          .surname +
                                                      ' ' +
                                                      production.getBranch[0]
                                                          .surname
                                                    : ''
                                                : ''
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            production
                                                ? production.getBranch[0].branch
                                                    ? production.getBranch[0]
                                                          .branch
                                                    : ''
                                                : ''
                                        }}
                                    </td>
                                    <td>{{ 'Motor' }}</td>
                                    <td>
                                        {{ production.risks[0].insuranceType }}
                                    </td>
                                    <!-- <td>{{ production.riskID }}</td> -->
                                    <td>
                                        {{
                                            production.sumInsured
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            production.netPremium
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{ production.levy | number: '1.2-2' }}
                                    </td>
                                    <!-- <td>
                                        {{
                                            production
                                                ? production.commission[0]
                                                      .commission
                                                    ? production.commission[0]
                                                          .commission
                                                    : ''
                                                : ''
                                        }}
                                    </td> -->
                                    <!-- <td>
                                      {{
                                        production.commission[0]

                                      }}
                                  </td> -->
                                  <td>
                                    {{
                                        production.netPremium * 0.14
                                            | number: '1.2-2'
                                    }}
                                </td>
                                    <td>{{ production.currency }}</td>
                                </tr>
                                <tr>
                                    <td>{{ 'TOTAL:ZMW' }}</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td>
                                        {{
                                            getSum('sumInsured')
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{
                                            getSum('netPremium')
                                                | number: '1.2-2'
                                        }}
                                    </td>
                                    <td>
                                        {{ getSum('levy') | number: '1.2-2' }}
                                    </td>
                                    <td>
                                        {{
                                            getSum('netPremium')  * 0.14 | number: '1.2-2'
                                        }}
                                    </td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </nz-table>
                    </div>
                </nz-card>
            </div>
        </nz-modal>
    </div>
</nz-spin>
